<p>This document describes how to format Markdown for OpenADR specification documents.</p>
<p>We strive to use normal Markdown as much as possible.  But, to make fine-looking documentation, we need some HTML post-processing and a few Markdown extensions.</p>
<div class="table-of-contents"><ul><li><a href="#file-names">File names</a></li><li><a href="#theory-of-operation">Theory of Operation</a><ul><li><a href="#custom-html-tags">Custom HTML tags</a></li></ul></li><li><a href="#css-style-sheets">CSS style sheets</a></li><li><a href="#adding-id-and-class-attributes-for-customizing-the-presentation">Adding ID and Class attributes for customizing the presentation</a></li><li><a href="#introducing-%3Cdiv%3E-blocks-around-a-section-of-markdown">Introducing <div> blocks around a section of Markdown</div></a></li><li><a href="#autogenerating-a-table-of-contents%2C-and-adding-anchors-to-hn-tags">Autogenerating a Table of Contents, and adding Anchors to Hn tags</a></li><li><a href="#adding-%3Csection%3E-tags-around-areas-started-with-an-hn-tag">Adding <section> tags around areas started with an Hn tag</section></a></li><li><a href="#generating-%3Cfigure%3E-and-%3Cfigcaption%3E-tags">Generating <figure> and <figcaption> tags</figcaption></figure></a></li><li><a href="#code-block-highlighting">Code block highlighting</a></li><li><a href="#diagrams---uml-or-otherwise---plantuml">Diagrams - UML or otherwise - PlantUML</a></li><li><a href="#alternate-approach-for-diagrams---draw.io">Alternate approach for Diagrams - <a href="http://draw.io">draw.io</a></a></li><li><a href="#autogenerated-enumerations-tables">Autogenerated Enumerations tables</a></li><li><a href="#rendering-markdown-to-html%2C-generating-pdf-from-html">Rendering Markdown to HTML, generating PDF from HTML</a><ul><li><a href="#rendering-to-html">Rendering to HTML</a></li><li><a href="#rendering-html-to-pdf">Rendering HTML to PDF</a></li></ul></li></ul></div>
<p>TODO: On studying this generated ToC - Some of the headers in this document have HTML tags.  The rendered header tag is <code>&lt;code&gt;&amp;lt;figure&amp;gt;&lt;/code&gt;</code> which correctly encodes this to safe HTML, but in the ToC the tags are rendered as raw HTML.  Hence, the ToC looks strange as a result.</p>
<section id="file-names" tabindex="-1">
<h1 tabindex="-1">File names</h1>
<p>The file names must be <code>.html.md</code> due to the design of AkashaCMS modules.  This can and will be changed shortly.</p>
</section>
<section id="theory-of-operation" tabindex="-1">
<h1 tabindex="-1">Theory of Operation</h1>
<p>The AkashaCMS tools use a Configuration object in <code>config.mjs</code>.  It describes a specific project - generally speaking an AkashaCMS project takes input files and produces a rendered output directory of HTML, CSS, images, and JavaScript.</p>
<p>The current configuration has <code>documents</code> containing Document files, <code>layouts</code> containing Layout templates, and <code>partials</code> containing Partial templates.  No <code>assets</code> directory has been created.</p>
<p>The rendered output is in <code>out</code>.</p>
<p>Document files have an extension corresponding to the document type.  For Markdown the extension is <code>.html.md</code>.  AsciiDoc files are also supported which would use the extension <code>.html.adoc</code>.  A stylesheet is included that is written using the LESSCSS format, and its extension is <code>.css.less</code>.</p>
<p>Markdown and AsciiDoc files have YAML-format frontmatter.</p>
<pre><code class="hljs"><span class="hljs-meta">---</span>
<span class="hljs-attr">layout:</span> <span class="hljs-string">default.html.ejs</span>
<span class="hljs-attr">title:</span> <span class="hljs-string">Article</span> <span class="hljs-string">title</span>
<span class="hljs-meta">---
</span></code></pre>
<p>This is a minimal frontmatter.  The <code>layout</code> field says which layout template to use, while <code>title</code> is recognized in <code>default.html.ejs</code> as the document title.</p>
<p>This layout template will be in EJS format.  Other template engines are supported such as Nunjucks (<code>.njk</code>).</p>
<p>The concept for the double extension is to make it clear what format is generated from that file.  The <code>.css.less</code> file generates a CSS file from LESSCSS format, while <code>.html.md</code> generates HTML from Markdown.</p>
<section id="custom-html-tags" tabindex="-1">
<h2 tabindex="-1">Custom HTML tags</h2>
<p>AkashaCMS also supports server-side DOM processing using a jQuery-like API.</p>
<p>The <code>&lt;img figure src=URL&gt;</code> support discussed later is an example of this DOM processing.  There is also HTML cleanup, a part of which is to automatically compute relative URL references for any <code>&lt;a&gt;</code> or <code>&lt;link&gt;</code> tag.</p>
<p>It also supports custom HTML tags that are automatically processed during page rendering, and replaced with corresponding HTML.</p>
<p>See the discussion of <code>&lt;schema-descriptions&gt;</code> below.</p>
</section>
</section>
<section id="css-style-sheets" tabindex="-1">
<h1 tabindex="-1">CSS style sheets</h1>
<p>Stylesheets are declared in <code>config.mjs</code> as so:</p>
<pre><code class="hljs language-js">.<span class="hljs-title function_">addStylesheet</span>({ <span class="hljs-attr">href</span>: <span class="hljs-string">&quot;/vendor/bootstrap/css/bootstrap.min.css&quot;</span> })
.<span class="hljs-title function_">addStylesheet</span>({       <span class="hljs-attr">href</span>: <span class="hljs-string">&quot;/style.css&quot;</span> });
</code></pre>
<p>That means Bootstrap v4.6.x is available, as is a custom stylesheet.  The source for this is <code>documents/style.css.less</code> and it is written in LESSCSS format.  This file is automatically converted to <code>style.css</code> during rendering.</p>
<p>Only a subset of Bootstrap is suitable for PDF rendering.</p>
</section>
<section id="adding-id-and-class-attributes-for-customizing-the-presentation" tabindex="-1">
<h1 tabindex="-1">Adding ID and Class attributes for customizing the presentation</h1>
<p>We commonly access CSS definitions using class attributes.  A Markdown-IT extension, <code>markdown-it-attrs</code>, has been installed which allows setting ID values and class attributes as so:</p>
<pre><code class="hljs language-md"><span class="hljs-section"># Introduction {.page<span class="hljs-emphasis">_break}
</span></span></code></pre>
<p>The format is to add <code>{ ... }</code> after an element.  The extension is configured to only allow <code>id</code> and <code>class</code> attributes.  You set a class attribute using the <code>.</code> character, hence <code>.page_break</code> becomes <code>class=&quot;page_break&quot;</code>.  To set an ID, use the <code>#</code> character such as <code>{ #introduction }</code></p>
</section>
<section id="introducing-%3Cdiv%3E-blocks-around-a-section-of-markdown" tabindex="-1">
<h1 tabindex="-1">Introducing <code>&lt;div&gt;</code> blocks around a section of Markdown</h1>
<p>We might want to use CSS specific to the &quot;title page&quot; that doesn&apos;t apply elsewhere.  Such CSS would have a selector <code>#title-page a { ... }</code> to, for example, customize anchor tags on the title page.</p>
<p>A Markdown-IT extension, <code>markdown-it-div</code>, has been installed for this purpose.  We could instead use <code>&lt;div&gt;</code> tags directly.  In any case, this extension works as so:</p>
<pre><code class="hljs language-md">::: #idName or .classNames

Some content

:::
</code></pre>
<p>Which would be rendered as:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;idName&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;or classNames&quot;</span>&gt;</span>
    Some content
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
</section>
<section id="autogenerating-a-table-of-contents%2C-and-adding-anchors-to-hn-tags" tabindex="-1">
<h1 tabindex="-1">Autogenerating a Table of Contents, and adding Anchors to Hn tags</h1>
<p>Two Markdown-IT extensions have been installed for the purpose of autogenerating a Table of Contents section.</p>
<p>First, <code>markdown-it-anchor</code> adds ID attributes to header tags.  ID attributes are what supports a link to the middle of a document.  For example, the tag <code>&lt;h1 id=&quot;introduction&quot;&gt;Introduction&lt;/h1&gt;</code> has an anchor named <code>introduction</code> and a link tag <code>&lt;a href=&quot;#introduction&gt;Introduction&lt;/a&gt;</code> will refer to that H1 tag.</p>
<p>This plugin, and the `markdown-it-attrs plugin, also supports the following</p>
<pre><code class="hljs"># Introduction { #introduction }
</code></pre>
<p>This allows the document author to specify the anchor ID rather than rely on an autogenerated anchor slug.</p>
<p>Second, <code>markdown-it-table-of-contents</code> scans the Markdown document looking for Hn tags, and automatically generates a Table of Contents.  Simply place the following in the document where the ToC is desired:</p>
<pre><code class="hljs"><span class="hljs-string">[[toc]]</span>
</code></pre>
<p>Because of the <code>anchor</code> plugin, the <code>table-of-contents</code> automatically links to the Hn tag using the anchor attribute.</p>
</section>
<section id="adding-%3Csection%3E-tags-around-areas-started-with-an-hn-tag" tabindex="-1">
<h1 tabindex="-1">Adding <code>&lt;section&gt;</code> tags around areas started with an Hn tag</h1>
<p>It may be useful to treat the portion of the document starting with a header tag as a <em>Section</em> of the document.  In HTML, sections are delimited by the <code>&lt;section&gt;</code> element.</p>
<p>The <code>markdown-it-header-sections</code> plugin automatically generates the following:</p>
<pre><code class="hljs"># <span class="hljs-selector-tag">Header</span> title of some kind

Some <span class="hljs-attribute">content</span> in <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">section</span>

More <span class="hljs-attribute">content</span> in <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">section</span>

# <span class="hljs-selector-tag">Header</span> title of the next <span class="hljs-selector-tag">section</span>

...
</code></pre>
<p>This is converted to:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Header title of some kind<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Some content in a section<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>More content in a section<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Header title of the next section<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    ...
    <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
</code></pre>
<p>The ID or Class values that can be added are automatically copied to the surrounding <code>&lt;section&gt;</code> tag.</p>
</section>
<section id="generating-%3Cfigure%3E-and-%3Cfigcaption%3E-tags" tabindex="-1">
<h1 tabindex="-1">Generating <code>&lt;figure&gt;</code> and <code>&lt;figcaption&gt;</code> tags</h1>
<p>The modern HTML way of handling images is this structure:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;alt text&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;URL&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">figcaption</span>&gt;</span>
        caption text
    <span class="hljs-tag">&lt;/<span class="hljs-name">figcaption</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span>
</code></pre>
<p>Since it can be tedious, and non-Markdowny, to type all that, the <code>markdown-it-image-figures</code> plugin handles this fairly easily.</p>
<pre><code class="hljs">!<span class="hljs-selector-attr">[alt text]</span>{URL &quot;<span class="hljs-selector-tag">caption</span> <span class="hljs-selector-tag">text</span>&quot;}
</code></pre>
<p>This is the standard Markdown way of specifying an image.</p>
<p>Alternatively, the AkashaCMS tools support the following:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">figure</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;URL&quot;</span> <span class="hljs-attr">caption</span>=<span class="hljs-string">&quot;caption text&quot;</span>/&gt;</span>
</code></pre>
<p>A module in AkashaCMS recognizes the <code>figure</code> attribute as a request to add the <code>&lt;figure&gt;</code> structure.  The <code>caption</code> attribute turns into <code>&lt;figcaption&gt;</code> text.  But, using this means not using the Markdown notation for images.</p>
</section>
<section id="code-block-highlighting" tabindex="-1">
<h1 tabindex="-1">Code block highlighting</h1>
<p>In Markdown, there are two kinds of code blocks.  An inline code block is &quot;`inline code`&quot;.  This is a pair of single back-quote characters inside of which is the code section.  There are many examples in this document already.</p>
<p>The long-form code block is a section delimited by lines starting with three back-quote characters.</p>
<p>The <code>markdown-it-highlightjs</code> plugin extends the treatment of the long-form code blocks with syntax highlighting.  There are many examples of this already in the document.  The initial back-quote delimiter has a language specifier such as &quot;```html&quot; for HTML.</p>
<p>See: <a href="https://highlightjs.org/">https://highlightjs.org/</a></p>
<p>Note that the Highlight.js ecosystem supports a large number of languages and themes.</p>
</section>
<section id="diagrams---uml-or-otherwise---plantuml" tabindex="-1">
<h1 tabindex="-1">Diagrams - UML or otherwise - PlantUML</h1>
<p>The OpenADR specification has a couple of UML diagrams.  With PlantUML support the diagram description can be placed inline in the document.  PlantUML converts this to SVG for display.</p>
<p>The PlantUML design requires a back-end server for UML rendering.  By default it uses the PlantUML server, but it is preferable to install a server locally.  That task has not been explored.</p>
<p>For example, we can add a Sequence diagram as so:</p>
<pre><code class="hljs">@startuml
participant Participant <span class="hljs-keyword">as</span> Foo
actor       Actor       <span class="hljs-keyword">as</span> Foo1
boundary    Boundary    <span class="hljs-keyword">as</span> Foo2
control     Control     <span class="hljs-keyword">as</span> Foo3
entity      Entity      <span class="hljs-keyword">as</span> Foo4
database    Database    <span class="hljs-keyword">as</span> Foo5
collections Collections <span class="hljs-keyword">as</span> Foo6
queue       Queue       <span class="hljs-keyword">as</span> Foo7
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo1 : To actor 
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo2 : To boundary
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo3 : To control
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo4 : To entity
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo5 : To database
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo6 : To collections
F<span class="hljs-function"><span class="hljs-title">oo</span> -&gt;</span> Foo7: To queue
@enduml
</code></pre>
<p>Which renders to the following:</p>
<img src="https://www.plantuml.com/plantuml/svg/JP4v3iCW44NxEGKNI16lKeh8MUj4oWKmfa1om86XyEs36JiP2dZwJupueWieFSRt25CwZJAJj2WUZ6KGT-T0AdHUq3en9hs7taKxI3ylsPan-GAKi-ZTcEzS69ClGLiqEDFC6sFo5GmIPI-3Nh8hO_9rcZ-EMg5nDgJvVoRVm2VggDStFncJRo5jOdVCNSH1l9oWmYmlAD-ACbEIMIioKP6WRYolATywCTDietuDc6opoqsWqtP8t_O5" alt="uml diagram">
</section>
<section id="alternate-approach-for-diagrams---draw.io" tabindex="-1">
<h1 tabindex="-1">Alternate approach for Diagrams - <code>draw.io</code></h1>
<p>At <a href="https://www.drawio.com/">https://www.drawio.com/</a> - one finds a web service, and desktop application, where one can draw diagrams.</p>
<p>The preferred workflow is:</p>
<ul>
<li>Draw the diagram in <code>draw.io</code></li>
<li>Save it as a PNG making sure to include the drawio diagram inside the PNG.</li>
<li>Include the PNG using normal Markdown image tags</li>
<li>Use <code>draw.io</code> to edit the PNG file to edit tie diagram</li>
</ul>
</section>
<section id="autogenerated-enumerations-tables" tabindex="-1">
<h1 tabindex="-1">Autogenerated Enumerations tables</h1>
<p>The Definitions document has several Enumeration tables.</p>
<p>The OpenADR project will contain JSON Schema files that correspond to these Enumeration tables.</p>
<p>In the spirit of <em>one source of truth</em> it is useful if the Enumeration tables are automatically generated from the Schema files.  That way the Enumeration tags and descriptions need only be written once, and be maintained in the Schema files.</p>
<p>To support this use:</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">schema-descriptions</span> 
        <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;event-payload-enumeration&quot;</span> 
        <span class="hljs-attr">schemahref</span>=<span class="hljs-string">&quot;/home/david/Projects/openadr/openapi-3.0.0/enumerations/event-interval-payloads.schema.yaml&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">schema-descriptions</span>&gt;</span>
</code></pre>
<p>The implementation for this tag is in <code>mahafuncs.mjs</code>, and is an example of custom HTML tags discussed earlier.</p>
<p>This tag reads the named Schema file - it only supports YAML format - then uses the following template to render the schema into the enumerations table.</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">table</span> {% <span class="hljs-attr">if</span> <span class="hljs-attr">id</span> %}<span class="hljs-attr">id</span>=<span class="hljs-string">&quot;{{ id | safe }}&quot;</span>{% <span class="hljs-attr">endif</span> %}&gt;</span>
    {% for def in defs -%}
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ def.key }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ def.description }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    {%- endfor %}
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
</code></pre>
<p>This template is in Nunjucks format.  The <code>id</code> attribute you see above is added to the <code>&lt;table&gt;</code>, then each <code>definitions</code> schema item is rendered as a table row.</p>
</section>
<section id="rendering-markdown-to-html%2C-generating-pdf-from-html" tabindex="-1">
<h1 tabindex="-1">Rendering Markdown to HTML, generating PDF from HTML</h1>
<p>The other tools for rendering Markdown to PDF typically have a middle step where the Markdown is rendered to HTML.</p>
<p>This setup makes the HTML step explicit and it can be inspected in the <code>out</code> directory.  That makes it easier to diagnose issues with generating the PDF.</p>
<p>Currently there is a script, <code>build.mjs</code>, and a related script <code>build-core.mjs</code>, that drives the process.  It is written in JavaScript as a ZX script. (<a href="https://google.github.io/zx/getting-started">https://google.github.io/zx/getting-started</a>)  The <code>build-core.mjs</code> script uses Puppeteer-core, which requires installing a separate Chrome instance.</p>
<p>Puppeteer is a tool containing a Chrome instance that can be run headless.  The primary target for Puppeteer is automated UI testing of web application front ends.  But, because it is a real web browser, it includes a Print to PDF function.</p>
<p>Script execution:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">time npx zx build.mjs</span> 

real	0m10.467s
user	0m7.597s
sys	0m1.575s
</code></pre>
<section id="rendering-to-html" tabindex="-1">
<h2 tabindex="-1">Rendering to HTML</h2>
<p>This portion of the script renders HTML from the documents:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> config } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./config.mjs&apos;</span>;

<span class="hljs-keyword">const</span> akasha = config.<span class="hljs-property">akasha</span>;
<span class="hljs-keyword">await</span> akasha.<span class="hljs-title function_">setup</span>(config);

<span class="hljs-comment">// await data.removeAll();</span>
<span class="hljs-keyword">await</span> config.<span class="hljs-title function_">copyAssets</span>();
<span class="hljs-keyword">let</span> results = <span class="hljs-keyword">await</span> akasha.<span class="hljs-title function_">render</span>(config);

<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">await</span> akasha.<span class="hljs-title function_">closeCaches</span>();
</code></pre>
<p>This is how one reads an AkashaCMS configuration, then renders its documents to the output directory.  There is a command-line option which is:</p>
<pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&#x24; </span><span class="language-bash">npx akasharender render --copy-assets config.mjs</span>
</code></pre>
<p>This portion of the script could be replaced with the above.</p>
</section>
<section id="rendering-html-to-pdf" tabindex="-1">
<h2 tabindex="-1">Rendering HTML to PDF</h2>
<p>With the HTML in the <code>out</code> directory the script moves on to launching Puppeteer.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> puppeteer <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;puppeteer&apos;</span>;
<span class="hljs-comment">// ...</span>

<span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.<span class="hljs-title function_">launch</span>({
    <span class="hljs-attr">headless</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">userDataDir</span>: <span class="hljs-string">&apos;./tmp&apos;</span>,
    <span class="hljs-attr">args</span>: [
        <span class="hljs-comment">// ...</span>
    ]
});

<span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newPage</span>();
<span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">`file://<span class="hljs-subst">&#x24;{__dirname}</span>/out/Definition.html`</span>, { <span class="hljs-attr">waitUntil</span>: <span class="hljs-string">&apos;networkidle0&apos;</span> });

<span class="hljs-comment">// Generate PDF at default resolution</span>
<span class="hljs-keyword">const</span> pdf = <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">pdf</span>({
    <span class="hljs-attr">format</span>: <span class="hljs-string">&apos;A4&apos;</span>,
    <span class="hljs-attr">margin</span>: { <span class="hljs-attr">top</span>: <span class="hljs-string">&apos;20mm&apos;</span>, <span class="hljs-attr">right</span>: <span class="hljs-string">&apos;20mm&apos;</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-string">&apos;20mm&apos;</span>, <span class="hljs-attr">left</span>: <span class="hljs-string">&apos;20mm&apos;</span> },
    <span class="hljs-attr">displayHeaderFooter</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">headerTemplate</span>: <span class="hljs-string">&apos;&lt;div class=&quot;title&quot;&gt;TITLE GOES HERE&lt;/div&gt;&apos;</span>,
    <span class="hljs-attr">footerTemplate</span>: <span class="hljs-string">&apos;&lt;div&gt;Page &lt;span class=&quot;pageNumber&quot;&gt;&lt;/span&gt; of &lt;span class=&quot;totalPages&quot;&gt;&lt;/span&gt;&lt;/div&gt;&apos;</span>,
    <span class="hljs-attr">printBackground</span>: <span class="hljs-literal">true</span>
});

<span class="hljs-comment">// Write PDF to file</span>
fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">&apos;PDF/Definition.pdf&apos;</span>, pdf);

<span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();
</code></pre>
<p>TODO: The headers and footers feature are not working at this moment.</p>
</section>
</section>
